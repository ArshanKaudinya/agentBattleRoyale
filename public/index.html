<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AI Battle Royale</title>
  <link rel="icon" type="image/png" href="/assets/logo.png">
  <link href="https://api.fontshare.com/v2/css?f[]=satoshi@400,401&f[]=clash-grotesk@400,600&f[]=cabinet-grotesk@400,900&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <!-- Header -->
  <header class="header">
    <div class="header-left">
      <h1 class="header-title">AI BATTLE ROYALE</h1>
      <p class="header-subtitle">Watch how agents think through high-risk survival</p>
    </div>
    <div class="header-right">
      <div class="turn-info">
        <span class="turn-label">Turn</span>
        <span class="turn-value" id="turn-display">0</span>
        <span class="turn-separator">/</span>
        <span class="turn-max">50</span>
      </div>
      <div class="zone-info">
        <span class="zone-label">Zone Radius</span>
        <span class="zone-value" id="zone-display">12</span>
      </div>
    </div>
  </header>

  <!-- Controls -->
  <div class="controls">
    <button class="btn btn-start" id="start-btn">Start Battle</button>
    <button class="btn btn-reset" id="reset-btn">Reset</button>
    <button class="btn btn-obstacle-mode" id="obstacle-mode-btn">
      <i class="fa-solid fa-chess-board"></i> Place Obstacles
    </button>
    <div class="obstacle-counter" id="obstacle-counter" style="display: none;">
      <span id="obstacle-count">0</span>/20 placed
    </div>
    <div class="status-indicator" id="status-indicator">
      <span class="status-dot"></span>
      <span class="status-text" id="status-text">Ready</span>
    </div>
    <button class="info-btn" id="info-btn" title="How It Works">
      <i class="fa-solid fa-circle-info"></i>
    </button>
    <button class="theme-toggle" id="theme-toggle" title="Toggle theme">
      <i class="fa-solid fa-moon"></i>
    </button>
  </div>

  <!-- Main 3-column layout -->
  <div class="main-container">
    <!-- Left Sidebar: Agent Cards -->
    <aside class="sidebar sidebar-left">
      <div class="sidebar-header">AGENTS</div>
      <div id="agent-cards-container"></div>
    </aside>

    <!-- Center: Battlefield -->
    <main class="battlefield-container">
      <div class="battlefield-header">BATTLEFIELD</div>
      <div class="canvas-wrapper">
        <canvas id="arena-canvas"></canvas>
      </div>
    </main>

    <!-- Commentary Column -->
    <aside class="sidebar sidebar-trash">
      <div class="sidebar-header">
        <i class="fa-solid fa-microphone"></i> LIVE COMMENTARY
      </div>
      <div id="commentary-feed" class="commentary-content"></div>
    </aside>

    <!-- Right Sidebar: Trash Talk -->
    <aside class="sidebar sidebar-right">
      <div class="sidebar-header">
        <i class="fa-solid fa-message"></i> TRASH TALK
      </div>
      <div id="trash-talk" class="trash-talk"></div>
    </aside>
  </div>

  <!-- Bottom: Combat Log & Agent Thoughts -->
  <div class="combat-log-panel">
    <div class="combat-section">
      <div class="panel-header">COMBAT LOG</div>
      <div id="combat-log" class="combat-log-content"></div>
    </div>
    <div class="commentary-section">
      <div class="panel-header"><i class="fa-solid fa-comments"></i> AGENT THOUGHTS</div>
      <div id="live-feed" class="live-feed"></div>
    </div>
  </div>

  <!-- Victory Modal -->
  <div id="victory-overlay" class="victory-overlay">
    <div class="victory-modal">
      <div class="victory-header">VICTORY</div>
      <canvas id="victory-sprite" class="victory-sprite"></canvas>
      <div id="victory-name" class="victory-name"></div>
      <div id="victory-archetype" class="victory-archetype"></div>
      <div id="victory-stats" class="victory-stats"></div>

      <!-- Match Statistics Table -->
      <div class="match-stats-section">
        <h3 class="stats-header">MATCH STATISTICS</h3>
        <table class="match-stats-table">
          <thead>
            <tr>
              <th>Agent</th>
              <th>Damage</th>
              <th>Kills</th>
              <th>Items</th>
              <th>Turns</th>
            </tr>
          </thead>
          <tbody id="stats-table-body">
            <!-- Populated by JavaScript -->
          </tbody>
        </table>
      </div>

      <!-- MVP Awards -->
      <div class="mvp-awards-section">
        <h3 class="stats-header">MVP AWARDS</h3>
        <div class="mvp-awards">
          <div class="mvp-card">
            <div class="mvp-icon"><i class="fa-solid fa-sword"></i></div>
            <div class="mvp-title">Damage King</div>
            <div class="mvp-winner" id="damage-king-name">-</div>
          </div>
          <div class="mvp-card">
            <div class="mvp-icon"><i class="fa-solid fa-heart"></i></div>
            <div class="mvp-title">Survivor</div>
            <div class="mvp-winner" id="survivor-name">-</div>
          </div>
          <div class="mvp-card">
            <div class="mvp-icon"><i class="fa-solid fa-treasure-chest"></i></div>
            <div class="mvp-title">Item Hoarder</div>
            <div class="mvp-winner" id="item-hoarder-name">-</div>
          </div>
        </div>
      </div>

      <button class="btn btn-play-again" onclick="resetGame()">Play Again</button>
    </div>
  </div>

  <!-- Info Modal -->
  <div id="info-overlay" class="info-overlay">
    <div class="info-modal">
      <div class="info-header">How It Works</div>
      <div class="info-content">
        <div class="info-section">
          <h4>The Concept</h4>
          <p>GPT-4 and Claude fight to the death in real-time tactical combat. Every decision is visible. Response speed becomes gameplay — faster API calls act first.</p>
        </div>

        <div class="info-section">
          <h4>Game Mechanics</h4>
          <ul>
            <li><strong>Turn-Based Combat:</strong> Agents decide simultaneously each turn based on identical game state</li>
            <li><strong>Shrinking Zone:</strong> Zone shrinks every 8 turns, forcing confrontation and dealing 5 damage per turn to agents outside</li>
            <li><strong>Items & Powerups:</strong> Items spawn every 3 turns creating contested objectives (health packs, damage amps, speed boosts, shields)</li>
            <li><strong>Last Agent Standing:</strong> Battle ends when only one agent survives or turn 50 is reached</li>
            <li><strong>Fastest First:</strong> Faster LLM response times act first — speed matters!</li>
          </ul>
        </div>

        <div class="info-section">
          <h4>What You're Watching</h4>
          <ul>
            <li><strong>Agent Reasoning:</strong> See their strategic thoughts in real-time as they analyze the battlefield</li>
            <li><strong>Live Commentary:</strong> AI-generated play-by-play analysis of key moments</li>
            <li><strong>Trash Talk:</strong> Contextual agent personality and taunts between competitors</li>
            <li><strong>Combat Log:</strong> Complete action history with damage tracking and turn-by-turn events</li>
            <li><strong>Thinking Indicators:</strong> Pulsing borders show which agents are currently "thinking" (waiting for LLM response)</li>
          </ul>
        </div>

        <div class="info-section">
          <h4>The Agents</h4>
          <p>Four LLM models compete: <span style="color: #10a37f">GPT-4 (gpt-4o)</span>, <span style="color: #d97757">Claude (claude-sonnet-4)</span>, <span style="color: #a0a0a0">Haiku (claude-haiku-4.5)</span>, and <span style="color: #9333ea">GPT-Mini (gpt-4o-mini)</span>. Each chooses an archetype (Berserker, Tank, Scout, Mage) and receives a random charm ability.</p>
        </div>
      </div>
      <button class="btn btn-close-info" id="close-info-btn">Got It</button>
    </div>
  </div>

  <!-- Kill Feed -->
  <div id="kill-feed" class="kill-feed"></div>

  <!-- Mobile Blocker -->
  <div class="mobile-blocker">
    <div class="mobile-blocker-content">
      <i class="fa-solid fa-desktop" style="font-size: 48px; margin-bottom: 20px;"></i>
      <h1>DESKTOP REQUIRED</h1>
      <p>This experience requires a larger screen.</p>
      <p>Please use a desktop or laptop computer.</p>
    </div>
  </div>

  <!-- Scripts -->
  <script src="pixels.js"></script>
  <script src="renderer.js"></script>
  <script src="app.js"></script>
</body>
</html>
